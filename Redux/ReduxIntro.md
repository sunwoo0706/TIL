## Redux

### Redux란 무엇인가?

액션이라는 객체를 사용하여 어플리케이션 상태를 관리하고 업데이트하기 위한 패턴이자 라이브러리를 redux라고 한다.
상태가 예축 가능한 방식으로만 업데이트될 수 있도록 보장하는 규칙과 함께 전체 어플리케이션에서 사용해야 하는 상태를 가지고 있는 중앙 저장소 역할을 한다.

### 어떤 어플리케이션에 유용한가?

- 앱의 여러 위치에 필요한 많은 양의 어플리케이션 상태가 있을 경우.
- 앱 상태가 시간이 지남에 따라 자주 업데이트될 경우.
- 해당 상태를 업데이트하는 로직이 복잡할 경우
- 앱에 중형 또는 대형 코드베이스가 있으며, 많은 사람들이 함께 작업하는 경우

## Redux 용어 및 개념

### 상태관리

- state : 앱을 구동하는 실태의 근원
- view : 최신 상태를 기반으로 하는 UI의 선언적 설명
- actions : 사용자 입력을 기반으로 앱에서 발생하는 이벤트 및 상태 업데이트 트리거

#### 단방향 데이터 흐름

- 상태는 특정 시점의 앱 상태를 나타낸다.
- UI는 해당 상태를 기반으로 렌더링된다.
- 사용자가 버튼을 클릭하는 것과 같은 이벤트가 발생하면 발생한 상황에 따라 상태가 업데이트된다.
- UI는 새 상태를 기반으로 다시 렌더링된다.

하지만 **동일한 상태를 공유하고 사용해야 하는 각각의 구성 요소**가 있는 경우, 특히 해당 구성 요소가 어플리케이션의 다른 부분에 있는 경우 복잡해질 수 있다. 때때로 이것은 상위 구셩 요소에서 상태를 끌어올리는것으로 해결할 수 있지만 항상 도움이 되는 것은 아니다.

이를 해결하는 한 가지 방법으로 구성 요소에서 공유 상태를 추출하여 구성 요소 트리 외부의 중앙 위치에 두는 것이 있다. 이를 통해 구성 요소 트리는 큰 보기가 되고 모든 구성 요소는 트리의 위치에 관계없이 상태에 액세스하거나 작업을 트리거할 수 있다.

상태 관리와 관련된 개념을 정의하고 분리하여 `view`와 `state`간의 독립성을 유지하는 규칙을 적용, 코드에 더 많은 구조와 유지 관리성을 제공한다. 이것이 Redux의 기본 아이디어이다. 어플리케이션의 전역 상태를 포함하는 중앙 집중식 단일 위치와 코드를 예측 가능하게 만들기 위해 해당 상태를 업데이트할 때 따라야할 특정 패턴이다.

### 불변성

JS 객체와 배열은 기본적으로 모두 변경 가능하다. 객체를 생성하면 해당 필드의 내용을 변경할 수 있다. 배열을 생성하면 배열 내용을 변경할 수 있다.
이것을 객체 또는 배열의 변형이라고 한다.

불변값을 업데이트하기 위해 코드는 기존 객체, 배열을 복사하고 사본을 수정하는 방식을 취해야 한다.

Js의 배열/객체 확산 연산자와 원래 배열을 변경하는 대신 배열의 새 복사본을 반환하는 spread 연산자를 사용하여 이 작업을 직접 수행해야 한다.

Redux는 모든 상태가 불변하게 업데이트 될거라 예상한다.

### Redux 전용 용어

#### Actions

Action은 type필드를 지닌 일반 자바스크립트 객체이다. 어플리케이션에서 일어난 어떠한 이벤트의 설명이라고 생각하면 된다.
type필드는 문자열이어야만 하며, 대부분 `"domain/eventName"` 으로 작성한다. 여기서 도메인은 이 작업이 속한 기능 또는 범주이고 두 번째 부분은 발생한 특정 항목이다.
액션 객체는 일어난 이벤트에 대한 정보를 추가할 수 있는 또 다른 필드를 추가할 수 있다. 컨벤션에 따라 이 필드명을 `payload`라고 부른다.

전형적인 Action 객체의 모습

```js
const addTodoAction = {
  type: 'todos/todoAdded',
  payload: 'Buy milk'
}
```

#### Action Creators

Action Creators는 Action 객체를 생성하고 반환하는 함수이다. 일반적으로 직접 Action 객체를 작성하지 않고 Action Creators를 사용한다.

#### Reducers

Reducer는 현재 상태와 액션 객체를 파라미터로 받는 함수이다. 필요할 경우 상태를 업데이트하는 방법을 결정한다. 또한 새로운 상태를 반환한다.
제공받은 Action type에 근간한 event를 다루는 eventListener라고 생각할 수 있다.

> Reducer 함수는 Array.reduce() 메서드에 전달하는 콜백 함수의 종류와 유사하기 때문에 해당 이름을 얻었다.

Reducer는 항시 몇몇 특정한 규칙이 따라 온다.

- state 및 action 인수를 기반으로 새 상태 값만 계산해내야 한다.
- 기존 상태를 수정할 수 없다. 대신 기존 상태를 복사하고 복사된 값을 변경하는 불변 업데이트를 수행해야 한다.
- 비동기 작업을 수행하거나, 일정하지 않은 값(랜덤값)을 계산하거나 또다른 사이드 이펙트를 일으키는 작업을 해서는 안된다.

Reducer 함수 내부 로직은 일반적으로 동일한 일련의 단계를 따른다.

- reducer가 action에 관심이 있는지 확인한다.
    - 그렇다면 상태의 복사본을 만들고 복사본을 새 값으로 업데이트하고 반환한다.
- 그렇지 않다면 기존 상태를 변경하지 않고 반환한다.

```js
const initialState = { value: 0 }

function counterReducer(state = initialState, action) {
  // reducer가 action에 관심이 있는지 확인한다.
  if (action.type === 'counter/increment') {
    // 그렇다면 상태의 복사본을 만들고
    return {
      ...state,
      // 복사본을 새 값으로 업데이트하고 반환한다.
      value: state.value + 1
    }
  }
  // 그렇지 않은 경우 그냥 변하지 않은 상태를 반환한다.
  return state
}
```

#### Store

앱의 현재 Redux state는 store라는 객체에 있다.

store는 reducer를 전달하여 생성한다. 그리고 현재 상태값을 반환하는 getStete라는 메서드가 있다.

#### Dispatch

Redux store에는 `dispatch`라는 메서드가 있다. `store.dispatch()`에 action 객체를 전달하여 액션을 호출하는것이 redux에서 유일하게 상태를 바꾸는 방법이다.

#### Selectors

Seletors는 store의 상태 값에서 특정 정보를 추출하는 방법을 알고 있는 함수이다. 앱이 커지면 앱의 서로 다른 부분이 동일한 데이터를 읽게 될 수 있고 이때 반복되는 로직를 방지하는 데 도움이 된다. [Selector에 대한 더 자세한 내용](Redux/Selectors.md)

## 비동기 상황에서의 Jest testing

Js에서는 언어 특성상 비동기 코드를 짜야할 일이 많습니다. Jest Runner가 비동기 코드에 대한 테스트하는 사실을 인지시켜줘야만 합니다.

#### 콜백 함수 테스트

Jest Runner는 기본적으로 테스트 함수를 그저 가능한한 최대한 빨리 호출해줍니다. 그래야 실행한 테스트가 많을 때도 성능이 좋아집니다.

그래서 기본적인 사용 방법으로 콜백함수를 테스트하면 콜백 함수는 호출될 기회조차 얻지 못하게 됩니다.

한마디로 안 기다리고 버리고 간다는 거죠.

해결 방법은 간단합니다. Jest Runner에게 명시적으로 이 테스트 함수는 비동기 코드를 테스트하니 콜백 함수가 호출되는지도 좀 봐주라고 알려주는 것입니다. 다음과 같이 실행할 테스트 함수가 `done()`이라는 함수 인자를 받도록 수정하고, 이 `done`함수를 콜백 함수의 제일 마지막에 호출하도록 수정합니다.

```js
test("fetch a user", done => {
  fetchUser(2, user => {
    expect(user).toEqual({
      id: 1,
      name: "User1",
      email: "1@test.com",
    });
    done();
  });
});
```
